---
title: "scatter_plots_avgACI"
author: "fatma parlak"
date: "2/10/2022"
output: html_document
---

```{r}
# Damon's directories
# dir_project <- "/Volumes/GoogleDrive/.shortcut-targets-by-id/1-9kU5O4-bU0AeEZKukSvz4jbvolppJGG/ddpham/Prewhitening-Paper" # Damon's personal
# dir_agg <- file.path(dir_project, "AC1_agg")
# dir_plots <- file.path(dir_project, "plots_avgACI")
# dir_lmm <- file.path(dir_project, "AC1_lmm")
# dir_plots <- file.path(dir_project, "plots_lmm")
# wb_path <- "~/Desktop/workbench" 

# Lab's directories
# wb_path <- "~/../Desktop/fMRI/workbench" 
# dir_project <- "G:/.shortcut-targets-by-id/1-9kU5O4-bU0AeEZKukSvz4jbvolppJGG/ddpham/Prewhitening-Paper"

# Fatma's directories
dir_project <- "/Volumes/GoogleDrive/My Drive/MEJIA_LAB_Fatma/Projects/Prewhitening_Paper"
dir_agg <- file.path(dir_project, "code", "AC1_agg") 
dir_plots <- file.path(dir_project, "code", "plots_avgACI")


# Setup ---------------------------------------------------------------------------------
library(ggplot2)
library(dplyr)
```

# Average ACI for each task, pw_FWHM, pw_order, HRF

```{r}
all_aci <- readRDS(file.path(dir_agg, "aci.rds"))
all_aci <- apply(all_aci, c(1,5,6,7), mean)
# dim(all_aci) # task 4, pw_FWHM 2, pw_order 4, HRF 2

all_aci2 <- array(dim=dim(all_aci) + c(1,0,0,0)) # adding an extra dimension to task
all_aci2[seq(4),,,] <- all_aci # save the calculated avg of ACI for each task from all_aci except the extra dimension
all_aci2[5,,,] <- colMeans(all_aci) # the extra dimension takes values of averaged values all tasks
dimnames_aci2 <- dimnames(all_aci) # using the same dimension names with the all_aci
dimnames_aci2$task <- c(dimnames_aci2$task, "all_task") # needed a name for the extra dimension 
dimnames(all_aci2) <- dimnames_aci2

iters <- do.call(expand.grid, dimnames(all_aci2)) # doing the same thing with the previously written code but shorter
df_aci <- data.frame(iters)
df_aci$avgACI <- c(all_aci2)

```


# Visualize the average ACI 
```{r}

ggplot(data = df_aci, aes(x = pw_order, y = avgACI, color = HRF)) +
            geom_point() +
            facet_grid(pw_FWHM~task) +
            theme_light()
ggsave("avgACI.png")

```



